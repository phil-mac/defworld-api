{
  "version": 3,
  "sources": ["../schema.ts"],
  "sourcesContent": ["const fs = require('fs');\nconst merge = require('lodash/merge');\nconst { gql } = require('apollo-server-core');\nconst { PubSub } = require('graphql-subscriptions');\nconst { Sequelize } = require('sequelize');\nconst { makeExecutableSchema } = require('@graphql-tools/schema');\n\nconst sequelize = new Sequelize(process.env.POSTGRES);\nconst pubsub = new PubSub();\n\nconst entities: any[] = [];\nconst models: Record<string, any> = {};\nconst typeDefImports: string[] = [];\n\nfs.readdirSync('./entities').forEach(file => {\n  const entityName = file.slice(0, -3);\n  const entity = require('./entities/' + entityName);\n\n  for (const property of ['define', 'resolvers', 'typeDefs']) {\n    if (!entity[property]) console.error(`No \"${property}\" found for \"${entityName}\" entity.`)\n  }\n\n  entities.push(entity);\n  \n  models[entityName] = entity.define(sequelize);\n\n  typeDefImports.push(entity.typeDefs);\n});\n\nconst typeDefs = gql`${typeDefImports.join('')}`;\n\n// could export \"association\" functions from elsewhere and call them using \"models\" here\nmodels.world.belongsToMany(models.user, { through: models.worldUser });\nmodels.user.belongsToMany(models.world, { through: models.worldUser });\nmodels.world.hasMany(models.node);\nmodels.node.belongsTo(models.world);\n\nconst resolvers = {};\nentities.forEach(entity => {\n  const entityResolvers = entity.resolvers(models, pubsub);\n  merge(resolvers, entityResolvers);\n});\n\nconst schema = makeExecutableSchema({ typeDefs, resolvers });\n\n// could export seedDatabase function from elsewhere, which takes \"models\" from here\nconst seedDatabase = async () => {\n  await sequelize.sync({ force: true });\n  \n  const userOne = await models.user.create({ username: 'Phil' });\n  const worldOne = await models.world.create({ name: 'Terra One'});\n\n  await models.worldUser.create({ userId: userOne.id, worldId: worldOne.id });\n  \n  const worldTwo = await models.world.create({ name: 'New world' });\n\n  await resolvers.Mutation.createNode(undefined, {worldId: worldOne.id, pos: [3, 3]})\n  await resolvers.Mutation.createNode(undefined, {worldId: worldOne.id, pos: [5, 2]})\n}\n\nmodule.exports = { schema, seedDatabase, models };\n"],
  "mappings": "AAAA,MAAM,KAAK,QAAQ;AACnB,MAAM,QAAQ,QAAQ;AACtB,MAAM,EAAE,QAAQ,QAAQ;AACxB,MAAM,EAAE,WAAW,QAAQ;AAC3B,MAAM,EAAE,cAAc,QAAQ;AAC9B,MAAM,EAAE,yBAAyB,QAAQ;AAEzC,MAAM,YAAY,IAAI,UAAU,QAAQ,IAAI;AAC5C,MAAM,SAAS,IAAI;AAEnB,MAAM,WAAkB;AACxB,MAAM,SAA8B;AACpC,MAAM,iBAA2B;AAEjC,GAAG,YAAY,cAAc,QAAQ,UAAQ;AAC3C,QAAM,aAAa,KAAK,MAAM,GAAG;AACjC,QAAM,SAAS,QAAQ,gBAAgB;AAEvC,aAAW,YAAY,CAAC,UAAU,aAAa,aAAa;AAC1D,QAAI,CAAC,OAAO;AAAW,cAAQ,MAAM,OAAO,wBAAwB;AAAA;AAGtE,WAAS,KAAK;AAEd,SAAO,cAAc,OAAO,OAAO;AAEnC,iBAAe,KAAK,OAAO;AAAA;AAG7B,MAAM,WAAW,MAAM,eAAe,KAAK;AAG3C,OAAO,MAAM,cAAc,OAAO,MAAM,EAAE,SAAS,OAAO;AAC1D,OAAO,KAAK,cAAc,OAAO,OAAO,EAAE,SAAS,OAAO;AAC1D,OAAO,MAAM,QAAQ,OAAO;AAC5B,OAAO,KAAK,UAAU,OAAO;AAE7B,MAAM,YAAY;AAClB,SAAS,QAAQ,YAAU;AACzB,QAAM,kBAAkB,OAAO,UAAU,QAAQ;AACjD,QAAM,WAAW;AAAA;AAGnB,MAAM,SAAS,qBAAqB,EAAE,UAAU;AAGhD,MAAM,eAAe,YAAY;AAC/B,QAAM,UAAU,KAAK,EAAE,OAAO;AAE9B,QAAM,UAAU,MAAM,OAAO,KAAK,OAAO,EAAE,UAAU;AACrD,QAAM,WAAW,MAAM,OAAO,MAAM,OAAO,EAAE,MAAM;AAEnD,QAAM,OAAO,UAAU,OAAO,EAAE,QAAQ,QAAQ,IAAI,SAAS,SAAS;AAEtE,QAAM,WAAW,MAAM,OAAO,MAAM,OAAO,EAAE,MAAM;AAEnD,QAAM,UAAU,SAAS,WAAW,QAAW,EAAC,SAAS,SAAS,IAAI,KAAK,CAAC,GAAG;AAC/E,QAAM,UAAU,SAAS,WAAW,QAAW,EAAC,SAAS,SAAS,IAAI,KAAK,CAAC,GAAG;AAAA;AAGjF,OAAO,UAAU,EAAE,QAAQ,cAAc;",
  "names": []
}
